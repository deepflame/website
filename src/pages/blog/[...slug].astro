---
import { getCollection } from 'astro:content';
import BlogLayout from '../../layouts/BlogLayout.astro';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  const sortedPosts = blogEntries.sort((a, b) => 
    b.data.date.valueOf() - a.data.date.valueOf()
  );
  
  return sortedPosts.map((entry, index) => {
    const nextPost = index > 0 ? sortedPosts[index - 1] : undefined; // next post is the newer one
    const previousPost = index < sortedPosts.length - 1 ? sortedPosts[index + 1] : undefined; // previous post is the older one
    
    return {
      params: { slug: entry.slug },
      props: { post: entry, previousPost, nextPost },
    };
  });
}

const { post, previousPost, nextPost } = Astro.props;
---
<BlogLayout post={post} previousPost={previousPost} nextPost={nextPost} />